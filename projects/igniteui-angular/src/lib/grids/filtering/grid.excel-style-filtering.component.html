<igx-icon [attr.draggable]="false" (click)="onIconClick($event)">filter_list</igx-icon>

<article #dropdown igxToggle
    class="igx-excel-filter__menu"
    (onClosing)="onDropDownClosing()"
    (onOpening)="onDropDownOpening()"
    (mouseenter)="onMenuMouseEnter($event)"
    >
    <header class="igx-excel-filter__menu-header">
        <h4 class="igx-typography__h6">{{ column.field }}</h4>
    </header>

    <section class="igx-excel-filter__sort">
        <header class="igx-typography__overline">Sorting</header>

        <igx-buttongroup #sortButtonGroup [multiSelection]="false">
            <span igxButton #ascButton type="button" [attr.data-togglable]="true" (click)="onSortButtonClicked(1)">
                <igx-icon>arrow_upwards</igx-icon>
                <span>Ascending</span>
            </span>

            <span igxButton #descButton type="button" [attr.data-togglable]="true" (click)="onSortButtonClicked(2)">
                <igx-icon>arrow_downwards</igx-icon>
                <span>Descending</span>
            </span>
        </igx-buttongroup>
    </section>

    <section class="igx-excel-filter__actions">

        <article class="igx-excel-filter__move">
            <header class="igx-typography__overline">Column moving</header>
            <section class="igx-excel-filter__move-buttons">
                <button
                    igxButton
                    [disabled]="canMoveLeft"
                    (click)="onMoveButtonClicked(-1)">
                    <igx-icon>arrow_back</igx-icon>
                    <span>left</span>
                </button>

                <!-- TODO: Rename canMoveRigth to canMoveRight -->
                <button
                    igxButton
                    [disabled]="canMoveRigth"
                    (click)="onMoveButtonClicked(1)">
                    <span>right</span>
                    <igx-icon>arrow_forwards</igx-icon>
                </button>
            </section>
        </article>

        <div class="igx-excel-filter__actions-pin"
            (click)="onPin()"
            *ngIf="!column.pinned">
            <span>Pin column</span>
            <igx-icon>lock</igx-icon>
        </div>

        <div class="igx-excel-filter__actions-unpin"
            (click)="onPin()"
            *ngIf="column.pinned">
            <span>Unpin column</span>
            <igx-icon>lock_open</igx-icon>
        </div>

        <div class="igx-excel-filter__actions-hide"
            (click)="onHide()">
            <span>Hide column</span>
            <igx-icon>visibility_off</igx-icon>
        </div>

        <div class="igx-excel-filter__actions-filter"
            (mouseenter)="onMouseEnter($event)"
            (mouseleave)="onMouseLeave()">
            <span>Text filter</span>
            <igx-icon>keyboard_arrow_right</igx-icon>
        </div>
    </section>

    <section class="igx-excel-filter__menu-main">
        <igx-input-group
            type="box"
            [displayDensity]="'compact'"
            [supressInputAutofocus]="true">
            <igx-icon igxPrefix>search</igx-icon>
            <input
                #input
                igxInput
                tabindex="0"
                [(ngModel)]="searchValue"
                placeholder="Search"
                autocomplete="off"/>
            <igx-icon
                igxSuffix
                *ngIf="searchValue || searchValue === 0"
                (click)="clearInput()"
                tabindex="0">
                clear
            </igx-icon>
        </igx-input-group>

        <igx-list [style.height.px]="250">
            <div [style.overflow]="'hidden'" [style.position]="'relative'">
                <igx-list-item tabindex="0"
                    *igxFor="let item of uniqueItems | igxFilter: filterOptions; scrollOrientation : 'vertical'; containerSize: '250px'; itemSize: '50px'">
                    <igx-checkbox
                    [value]="item"
                    [checked]="item.isSelected"
                    [disableRipple]="true"
                    [indeterminate]="item.indeterminate"
                    [disableTransitions]="true"
                    (change)="onCheckboxChange($event)">
                        {{item.value}}
                    </igx-checkbox>
                </igx-list-item>
            </div>
        </igx-list>
    </section>

    <footer class="igx-excel-filter__menu-footer">
        <button igxButton (click)="closeDialog()">Cancel</button>
        <button igxButton="raised" (click)="applyFilter()">Apply</button>
    </footer>
</article>

<igx-drop-down #subMenu (onClosed)="onSubMenuClosed()" (onSelection)="onSubMenuSelection($event)">
    <div style="width: 200px" (mouseover)="onSubMenuMouseEnter()" (mouseout)="onSubMenuMouseLeave()" >
        <igx-drop-down-item
            *ngFor="let condition of conditions"
            [value]="condition">
            <igx-icon fontSet="filtering-icons" [name]="getCondition(condition).iconName"></igx-icon>
            <span style="margin-left: 16px">{{ translateCondition(condition) }}</span>
        </igx-drop-down-item>
    </div>
</igx-drop-down>

<article #customMenu igxToggle
    class="igx-excel-filter__secondary"
    (onOpening)="onCustomMenuOpening()">
    <header class="igx-excel-filter__secondary-header">
        <h4 class="igx-typography__h6">
            Custom auto-filter on column: {{ column.field }}
        </h4>
    </header>

    <section *ngFor="let item of expressionsList; let last = last;" class="igx-excel-filter__condition">
        <igx-drop-down #dropdownConditions [height]="'200px'" (onSelection)="onConditionsChanged($event, item, inputValues)">
            <igx-drop-down-item *ngFor="let condition of conditions" [value]="condition" [isSelected]="isConditionSelected(condition, item)">
                <igx-icon fontSet="filtering-icons" [name]="getCondition(condition).iconName"></igx-icon>
                <span>{{ translateCondition(condition) }}</span>
            </igx-drop-down-item>
        </igx-drop-down>

        <igx-input-group
            #inputGroupConditions
            (click)="toggleCustomMenuDropDown(inputGroupConditions, dropdownConditions)"
            type="box"
            [displayDensity]="'compact'"
            [supressInputAutofocus]="true">

            <igx-prefix tabindex="0" [igxDropDownItemNavigation]="dropdownConditions">
                <igx-icon *ngIf="item.expression.condition" fontSet="filtering-icons" [name]="getIconName(item)"></igx-icon>
                <igx-icon *ngIf="!item.expression.condition">filter_list</igx-icon>
            </igx-prefix>

            <input
                igxInput
                tabindex="0"
                placeholder="placeholder"
                autocomplete="off"
                [value]="getConditionName(item.expression.condition)"
                [readonly]="true"
            />
        </igx-input-group>

        <igx-drop-down #dropdownValues [height]="'200px'" (onSelection)="onValuesChanged($event, item, inputValues)" (onOpening)="onDropdownValuesOpening(dropdownValues, inputValues)">
            <igx-drop-down-item *ngFor="let filterItem of uniqueItems" [value]="filterItem.value" [isSelected]="isValueSelected(filterItem, item)">
                <span>{{ filterItem.value }}</span>
            </igx-drop-down-item>
        </igx-drop-down>

        <igx-input-group #inputGroupValues type="box" [displayDensity]="'compact'" [supressInputAutofocus]="true">
            <input
                #inputValues
                igxInput
                tabindex="0"
                placeholder="placeholder"
                autocomplete="off"
                [igxDropDownItemNavigation]="dropdownValues"
                [(ngModel)]="item.expression.searchVal"
               />

            <igx-icon igxSuffix tabindex="0"
                (click)="toggleCustomMenuDropDown(inputGroupValues, dropdownValues)"
                [igxDropDownItemNavigation]="dropdownValues">
                arrow_drop_down
            </igx-icon>
        </igx-input-group>

        <button (click)="onRemoveButtonClick(item)" igxButton="icon" *ngIf="expressionsList.length > 1">
            <igx-icon>cancel</igx-icon>
        </button>

        <igx-buttongroup #logicOperatorButtonGroup
            *ngIf="!last"
            [multiSelection]="false">
            <span igxButton
                #andButton
                [selected]="true"
                type="button"
                (click)="onLogicOperatorButtonClicked($event, logicOperatorButtonGroup, 0, item)">
                And
            </span>

            <span igxButton
                #orButton
                type="button"
                (click)="onLogicOperatorButtonClicked($event, logicOperatorButtonGroup, 1, item)">
                Or
            </span>
        </igx-buttongroup>
    </section>

    <button igxButton
        class="igx-excel-filter__add-filter"
        (click)="onAddButtonClick()">
        <igx-icon>add</igx-icon>
        <span>Add Filter</span>
    </button>

    <footer class="igx-excel-filter__secondary-footer">
        <button igxButton (click)="onClearButtonClick()">Clear filter</button>

        <div>
            <button igxButton (click)="onCancelButtonClick()">Cancel</button>
            <button igxButton="raised" (click)="onApplyButtonClick()">Apply</button>
        </div>
    </footer>
</article>
